import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as n}from"./index-RUgJCupv.js";import{a as b}from"./index-t--hEgTQ.js";import{F as v,a as N}from"./index-3o5017id.js";import{u as I}from"./authCOntext-Dl5rGXJ7.js";import{u as S}from"./index-Dou5fCe0.js";const k="/assets/login-Br94nNP3.svg";function C(){const c=S(),{login:h}=I(),[r,u]=n.useState({email:"",password:"",remember:!1}),[m,x]=n.useState({email:!1,password:!1}),[p,f]=n.useState(!1),[g,l]=n.useState(null);n.useEffect(()=>{const o=localStorage.getItem("email"),a=localStorage.getItem("password");o&&a&&u({email:o,password:a,remember:!0})},[]);const d=o=>{const{name:a,value:s,type:t,checked:i}=o.target;u({...r,[a]:t==="checkbox"?i:s}),x({...m,[a]:!1}),l(null)},w=async()=>{var o,a;try{return{...await b.post("http://3.142.142.153:5000/api/users/login",{email:r.email,password:r.password}),userType:"Usuario"}}catch(s){if((a=(o=s==null?void 0:s.response)==null?void 0:o.data)!=null&&a.message&&s.response.data.message.includes("El usuario no tiene rol válido."))try{return{...await b.post("http://3.142.142.153:5000/api/admins/login",{email:r.email,password:r.password}),userType:"Admin"}}catch(t){throw t}else throw s}},j=async o=>{o.preventDefault();const a={email:r.email.trim()==="",password:r.password.trim()===""};if(x(a),!Object.values(a).some(s=>s)){f(!0);try{const s=await w();if(s.status===200){const{role:t,token:i,user:y}=s.data;localStorage.setItem("authToken",i),localStorage.setItem("userRole",t),r.remember?(localStorage.setItem("email",r.email),localStorage.setItem("password",r.password)):(localStorage.removeItem("email"),localStorage.removeItem("password")),h({...y,role:t},i),t==="Admin"||t===2?c("/admin"):t==="Usuario"||t===1?c("/novedades"):t==="superadmin"?c("/super-admin"):l("Rol desconocido. Contacta al administrador.")}else l("Hubo un problema al iniciar sesión.")}catch(s){s.response?l(s.response.data.message||"Credenciales incorrectas"):s.request?l("No se pudo conectar con el servidor. Verifica tu conexión."):l("Ocurrió un error inesperado. Intenta nuevamente.")}finally{f(!1)}}};return e.jsx("section",{className:"login-section flex flex-col items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center w-full h-full",children:[e.jsx("div",{className:"flex justify-center items-center h-[800px] md:w-2/5",children:e.jsx("img",{src:k,alt:"Login",className:"max-w-full h-full object-contain"})}),e.jsx("div",{className:"w-full md:w-2/5 bg-white p-8 rounded shadow-2xl mb-8 md:mb-0 md:ml-4 min-h-[700px] flex items-center justify-center",children:e.jsxs("form",{onSubmit:j,className:"w-full p-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-center mb-2 text-black",children:"Bienvenido a tu"}),e.jsx("h2",{className:"text-xl font-bold text-center mb-6 text-[#2C395B]",children:"Banco de Oportunidades"}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-center w-full bg-white border border-gray-300 text-gray-700 py-3 px-5 rounded hover:bg-gray-100 text-lg",disabled:!0,children:[e.jsx(v,{className:"h-6 w-6 mr-2 text-red-500"}),"Ingresa con Google"]}),e.jsxs("button",{type:"button",className:"flex items-center justify-center w-full bg-[#1877F2] text-white py-3 px-5 rounded hover:bg-[#145dbf] text-lg",disabled:!0,children:[e.jsx(N,{className:"h-6 w-6 mr-2"}),"Ingresa con Facebook"]}),e.jsxs("div",{className:"flex items-center justify-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("span",{className:"mx-4 text-gray-500",children:"o"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]})]}),g&&e.jsx("p",{className:"text-red-500 text-center mb-4",children:g}),e.jsx("div",{className:"relative mb-4 flex items-center",children:e.jsx("input",{type:"email",id:"email",name:"email",placeholder:"Correo Electrónico",value:r.email,onChange:d,className:`w-full px-4 py-3 border rounded bg-[#ececec] text-black text-lg focus:outline-none focus:ring-2 ${m.email?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,required:!0})}),e.jsx("div",{className:"relative mb-4 flex items-center",children:e.jsx("input",{type:"password",id:"password",name:"password",placeholder:"Contraseña",value:r.password,onChange:d,className:`w-full px-4 py-3 border rounded bg-[#ececec] text-black text-lg focus:outline-none focus:ring-2 ${m.password?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,required:!0})}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("label",{className:"flex items-center text-black",children:[e.jsx("input",{type:"checkbox",className:"mr-2",name:"remember",checked:r.remember,onChange:d}),"Recordarme"]})}),e.jsx("button",{type:"submit",className:"w-3/4 bg-[#FFBA08] text-white py-3 px-5 rounded hover:bg-yellow-500 mx-auto block text-lg",disabled:p,children:p?"Cargando...":"Ingresar"})]})})]})})}function q(){return e.jsx(C,{})}export{q as default};
